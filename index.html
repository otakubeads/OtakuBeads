<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Otaku Beads | Expressive UI</title>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Roboto:wght@400;500;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet">
    <style id="dynamic-theme"></style>
    <style>
        :root {
            --spring-bounce: cubic-bezier(0.3, 1.5, 0.5, 1);
            --spring-standard: cubic-bezier(0.2, 0, 0, 1);
        }

        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; margin: 0; padding: 0; transition: background-color 0.4s var(--spring-standard), color 0.4s var(--spring-standard); }
        
        body { 
            font-family: 'Google Sans', 'Roboto', sans-serif; 
            background: var(--md-sys-color-surface); 
            color: var(--md-sys-color-on-surface);
            overflow-x: hidden;
        }

        /* --- EXPRESSIVE TOP BAR --- */
        .timer-bar { position: sticky; top: 0; z-index: 1200; display: flex; justify-content: center; height: 110px; pointer-events: none; }
        .timer-pill { 
            background: var(--md-sys-color-primary-container); color: var(--md-sys-color-on-primary-container);
            padding: 16px 32px; border-radius: 28px; transform: translateY(20px); pointer-events: auto;
            box-shadow: var(--md-sys-elevation-3); text-align: center; border: 1px solid var(--md-sys-color-outline-variant);
        }

        /* --- GRID & CARDS --- */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; padding: 16px; padding-bottom: 200px; }
        .card { 
            background: var(--md-sys-color-surface-container-low); border-radius: 32px; padding: 14px; 
            position: relative; transition: all 0.4s var(--spring-bounce); border: 1px solid transparent;
        }
        .card:active { transform: scale(0.94); background: var(--md-sys-color-surface-container-high); }
        .card img { width: 100%; aspect-ratio: 1/1; border-radius: 24px; object-fit: cover; margin-bottom: 12px; }

        /* --- BUTTONS --- */
        .btn { border: none; height: 54px; border-radius: 18px; font-weight: 700; cursor: pointer; transition: 0.3s var(--spring-standard); width: 100%; margin-top: 8px; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-primary { background: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); }
        .btn-tonal { background: var(--md-sys-color-secondary-container); color: var(--md-sys-color-on-secondary-container); }

        /* --- THEME FAB --- */
        .theme-fab { position: fixed; top: 24px; right: 24px; z-index: 2000; width: 56px; height: 56px; border-radius: 16px; background: var(--md-sys-color-surface-container-highest); border: none; display: flex; align-items: center; justify-content: center; box-shadow: var(--md-sys-elevation-2); color: var(--md-sys-color-primary); cursor: pointer; }

        /* --- EXPRESSIVE SHEET --- */
        .sheet { position: fixed; inset: 0; z-index: 3000; transform: translateY(100%); transition: transform 0.6s cubic-bezier(0.1, 0.8, 0.2, 1); background: var(--md-sys-color-surface-container-highest); display: flex; flex-direction: column; border-radius: 42px 42px 0 0; }
        .sheet.active { transform: translateY(0); }
        .qty-pill { display: flex; align-items: center; gap: 12px; background: var(--md-sys-color-surface-variant); padding: 8px; border-radius: 24px; }
        .qty-btn { width: 42px; height: 42px; border-radius: 16px; border: none; background: var(--md-sys-color-surface); color: var(--md-sys-color-primary); font-size: 20px; font-weight: 900; }

        .promo-tag { position: absolute; top: 12px; left: 12px; background: var(--md-sys-color-error); color: var(--md-sys-color-on-error); padding: 6px 14px; border-radius: 14px; font-size: 11px; font-weight: 900; z-index: 10; transform: rotate(-3deg); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <button class="theme-fab" onclick="THEME_ENGINE.toggle()">
        <span class="material-symbols-rounded" id="theme-icon">dark_mode</span>
    </button>

    <div class="timer-bar">
        <div id="t-pill" class="timer-pill">
            <span style="font-size: 10px; font-weight: 900; opacity: 0.8; letter-spacing: 1.5px;">PROMO ENDS IN</span>
            <div id="t-text" style="font-size: 22px; font-weight: 900; font-variant-numeric: tabular-nums;">00:00:00</div>
        </div>
    </div>

    <header style="padding: 30px 20px; display: flex; align-items: center; gap: 16px;">
        <img src="logo.jpg" style="width:52px; height:52px; border-radius:18px; box-shadow: var(--md-sys-elevation-1);" onerror="this.src='logo.jpg'">
        <h1 style="font-size: 28px; font-weight: 700; flex: 1; letter-spacing: -0.5px;">Otaku Beads</h1>
    </header>

    <main class="grid" id="main-grid"></main>

    <button style="position:fixed; bottom:32px; left:24px; right:24px; height:84px; background:var(--md-sys-color-primary); color:var(--md-sys-color-on-primary); border-radius:32px; border:none; font-weight:700; font-size: 18px; z-index:1001; box-shadow: var(--md-sys-elevation-4);" onclick="MODULE_UI.toggleBag(true)">
        Review Bag (<span id="bag-count">0</span>)
    </button>

    <div id="bag-sheet" class="sheet">
        <div style="height: 5px; width: 45px; background: var(--md-sys-color-outline); border-radius: 3px; margin: 15px auto; opacity: 0.3;"></div>
        <div style="padding: 16px 28px; display: flex; align-items: center; justify-content: space-between;">
            <h2 style="font-size: 26px; font-weight: 700;">Your Bag</h2>
            <button onclick="MODULE_CORE.clear()" style="background:none; border:none; color:var(--md-sys-color-error); font-weight:700;">Clear</button>
        </div>
        <div id="bag-items" style="flex: 1; overflow-y: auto; padding: 16px;"></div>
        <div style="padding: 32px 24px; background: var(--md-sys-color-surface-container-high); border-radius: 48px 48px 0 0; box-shadow: 0 -10px 40px rgba(0,0,0,0.15);">
            <div style="display:flex; justify-content: space-between; margin-bottom: 24px; align-items: center;">
                <span style="font-weight: 500; opacity: 0.6;">Estimated Total</span>
                <span id="bag-total" style="font-size: 34px; font-weight: 900; color: var(--md-sys-color-primary);">R 0.00</span>
            </div>
            <button class="btn btn-primary" style="height: 76px; border-radius: 24px; font-size: 20px;" onclick="MODULE_CORE.checkout()">Confirm on WhatsApp</button>
        </div>
    </div>

    <script>
        /* --- STANDALONE THEME ENGINE --- */
        const THEME_ENGINE = (() => {
            let dark = localStorage.getItem('otaku_dark') === 'true';
            const palette = {
                light: { primary: "#6750A4", onPrimary: "#FFFFFF", primaryContainer: "#EADDFF", onPrimaryContainer: "#21005D", surface: "#FEF7FF", onSurface: "#1D1B20", surfaceVariant: "#E7E0EB", onSurfaceVariant: "#49454F", surfaceContainerLow: "#F7F2FA", surfaceContainerHigh: "#ECE6F0", surfaceContainerHighest: "#E6E0E9", error: "#B3261E", onError: "#FFFFFF", outline: "#79747E", outlineVariant: "#CAC4D0", elevation2: "0 2px 6px rgba(0,0,0,0.08)", elevation3: "0 6px 12px rgba(0,0,0,0.12)", elevation4: "0 12px 24px rgba(103,80,164,0.3)" },
                dark: { primary: "#D0BCFF", onPrimary: "#381E72", primaryContainer: "#4F378B", onPrimaryContainer: "#EADDFF", surface: "#141218", onSurface: "#E6E1E5", surfaceVariant: "#49454F", onSurfaceVariant: "#CAC4D0", surfaceContainerLow: "#1D1B20", surfaceContainerHigh: "#2B2930", surfaceContainerHighest: "#332F37", error: "#F2B8B5", onError: "#601410", outline: "#938F99", outlineVariant: "#49454F", elevation2: "0 4px 10px rgba(0,0,0,0.3)", elevation3: "0 8px 20px rgba(0,0,0,0.4)", elevation4: "0 12px 30px rgba(0,0,0,0.5)" }
            };
            return {
                apply() {
                    const t = dark ? palette.dark : palette.light;
                    let css = `:root {`;
                    for(let k in t) css += `--md-sys-color-${k.replace(/[A-Z]/g, m=>"-"+m.toLowerCase())}: ${t[k]};`;
                    css += `}`;
                    document.getElementById('dynamic-theme').innerHTML = css;
                    document.getElementById('theme-icon').innerText = dark ? 'light_mode' : 'dark_mode';
                },
                toggle() { dark = !dark; localStorage.setItem('otaku_dark', dark); this.apply(); }
            };
        })();

        const MODULE_CORE = (() => {
            const deadline = new Date("Jan 31, 2026 23:59:59").getTime();
            let cart = JSON.parse(localStorage.getItem('otaku_cart_v3')) || [];
            return {
                getCart: () => cart,
                getPrice: (id) => id <= 2 ? 45 : 65,
                add(id) { cart.push(id); this.save(); },
                remove(id) { const i = cart.lastIndexOf(id); if(i>-1) cart.splice(i,1); this.save(); },
                clear() { if(confirm("Discard all?")) { cart=[]; this.save(); MODULE_UI.toggleBag(false); } },
                save() { localStorage.setItem('otaku_cart_v3', JSON.stringify(cart)); document.getElementById('bag-count').innerText = cart.length; MODULE_RENDERER.refresh(); },
                checkout() {
                    const counts = cart.reduce((a,c)=>{ a[c]=(a[c]||0)+1; return a; }, {});
                    let m = "Otaku Beads Order:%0A";
                    Object.keys(counts).forEach(id => m += `✅ Design #${id} x${counts[id]}%0A`);
                    window.open(`https://wa.me/27XXXXXXXXX?text=${encodeURIComponent(m)}`);
                }
            };
        })();

        const MODULE_RENDERER = (() => {
            return {
                refresh() { this.grid(); this.bag(); },
                grid() {
                    const g = document.getElementById('main-grid');
                    const counts = MODULE_CORE.getCart().reduce((a,c)=>{ a[c]=(a[c]||0)+1; return a; }, {});
                    let h = "";
                    for(let i=1; i<=28; i++) {
                        const q = counts[i] || 0;
                        if(i === 26) {
                            h += `<div class="card" style="opacity: 0.5"><img src="26.jpg" onerror="this.src='logo.jpg'"><div style="font-weight:700;">#26</div><button class="btn btn-tonal" disabled>Coming Soon</button></div>`;
                        } else {
                            h += `<div class="card">
                                ${i<=2?'<div class="promo-tag">BUY 2 GET 1</div>':''}
                                <img src="${i}.jpg" onerror="this.src='logo.jpg'">
                                <div style="font-weight:700; font-size:16px;">Design #${i}</div>
                                <div style="color:var(--md-sys-color-primary); font-weight:900; font-size: 15px; margin-bottom: 8px;">R ${MODULE_CORE.getPrice(i)}.00</div>
                                <button class="btn btn-tonal" onclick="window.open('https://wa.me/27XXXXXXXXX?text=Info on #${i}')">Info</button>
                                <button class="btn ${q>0?'btn-tonal':'btn-primary'}" onclick="MODULE_CORE.add(${i})">${q>0? q+' in Bag':'Add to Bag'}</button>
                            </div>`;
                        }
                    }
                    g.innerHTML = h;
                },
                bag() {
                    const list = document.getElementById('bag-items');
                    const counts = MODULE_CORE.getCart().reduce((a,c)=>{ a[c]=(a[c]||0)+1; return a; }, {});
                    let total = 0;
                    list.innerHTML = Object.keys(counts).map(id => {
                        const p = MODULE_CORE.getPrice(id); total += (p * counts[id]);
                        return `<div class="bag-item">
                            <img src="${id}.jpg" style="width:70px; height:70px; border-radius:18px" onerror="this.src='logo.jpg'">
                            <div style="flex:1;"><div style="font-weight:700;">Design #${id}</div><div style="color:var(--md-sys-color-primary); font-weight:900;">R ${p}.00</div></div>
                            <div class="qty-pill">
                                <button class="qty-btn" onclick="MODULE_CORE.remove(${id})">－</button>
                                <span style="font-weight:900; min-width:28px; text-align:center">${counts[id]}</span>
                                <button class="qty-btn" onclick="MODULE_CORE.add(${id})">＋</button>
                            </div>
                        </div>`;
                    }).join('') || '<div style="text-align:center; padding:80px; opacity:0.3; font-weight:700;">EMPTY BAG</div>';
                    document.getElementById('bag-total').innerText = `R ${total}.00`;
                }
            };
        })();

        const MODULE_UI = { toggleBag(s) { document.getElementById('bag-sheet').classList.toggle('active', s); } };

        (() => {
            THEME_ENGINE.apply();
            MODULE_RENDERER.refresh();
            document.getElementById('bag-count').innerText = MODULE_CORE.getCart().length;
            setInterval(() => {
                const diff = new Date("Jan 31, 2026 23:59:59").getTime() - Date.now();
                if(diff <= 0) return;
                const h = Math.floor((diff%86400000)/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
                document.getElementById('t-text').innerText = `${h}h ${m}m ${s}s`;
            }, 1000);
        })();
    </script>
</body>
</html>
